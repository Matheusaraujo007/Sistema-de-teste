<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“¦ Meus Pedidos</title>
<style>
body{font-family:"Segoe UI",Arial,sans-serif;background:#f4f7fb;margin:0;padding:20px;}
h1{text-align:center;color:#2f7fb3;margin-bottom:20px;}
.pedido-card{background:white;border-radius:10px;box-shadow:0px 3px 10px rgba(0,0,0,0.1);padding:15px;margin-bottom:15px;transition:0.3s;}
.pedido-card:hover{transform:translateY(-3px);box-shadow:0px 5px 15px rgba(0,0,0,0.15);}
.pedido-header{display:flex;justify-content:space-between;align-items:center;font-weight:bold;color:#333;flex-wrap:wrap;}
.pedido-info{margin-top:10px;font-size:14px;color:#555;}
.pedido-info ul{padding-left:20px;margin:5px 0;}
.status{padding:5px 10px;border-radius:6px;font-size:12px;font-weight:bold;}
.pendente{background:#ffeb99;color:#a67c00;}
.aprovada{background:#cce5ff;color:#004085;}
.finalizado{background:#d4edda;color:#155724;}
.cancelado{background:#f8d7da;color:#721c24;}
.voltar{display:block;text-align:center;margin-top:20px;background:#2f7fb3;color:white;padding:10px;border-radius:8px;text-decoration:none;font-weight:bold;}
.voltar:hover{background:#25658d;}
/* Texto no canto superior esquerdo */
.dev-credit{
    position: fixed;
    top: 5px;
    left: 10px;
    font-size: 11px;
    color: #555;
    font-style: italic;
    z-index: 1000;
}
</style>
</head>
<body>

<div class="dev-credit">Desenvolvido por <strong>MTScomputadores</strong></div>

<h1>ðŸ“¦ Meus Pedidos</h1>
<div id="listaPedidos"></div>
<a href="index.html" class="voltar">â¬… Voltar</a>

<script>
function formatarData(dataStr) {
    if (!dataStr) return "";
    const data = new Date(dataStr);
    const dia = String(data.getDate()).padStart(2, '0');
    const mes = String(data.getMonth() + 1).padStart(2, '0');
    const ano = data.getFullYear();
    return `${dia}/${mes}/${ano}`;
}

async function carregarPedidos() {
  const res = await fetch("/api/pedidos");
  const pedidos = await res.json();

  const container = document.getElementById("listaPedidos");
  container.innerHTML = "";

  pedidos.forEach(pedido => {
    const div = document.createElement("div");
    div.classList.add("pedido-card");

    div.innerHTML = `
      <h3>Pedido de ${pedido.vendedor}</h3>
      <p><strong>Cliente:</strong> ${pedido.nome_cliente}</p>
      <p><strong>Telefone:</strong> ${pedido.telefone_cliente}</p>
      <p><strong>Produtos:</strong></p>
      <ul>
        ${pedido.itens.map(item => `
          <li>${item.nome} - ${item.quantidade} un. (R$ ${item.valor})</li>
        `).join("")}
      </ul>
      <p><strong>Valor Total:</strong> R$ ${pedido.valor_total}</p>
      <p><strong>Valor Recebido:</strong> R$ ${pedido.valor_recebido}</p>
      <p><strong>Data Pedido:</strong> ${pedido.data_pedido}</p>
      <p><strong>Data Entrega:</strong> ${pedido.data_entrega}</p>
      <span class="status">${pedido.status}</span>
    `;

    container.appendChild(div);
  });
}

// Carrega inicialmente
carregarPedidos();

// Atualiza automaticamente a cada 5s
setInterval(carregarPedidos, 5000);
</script>
</body>
</html>
